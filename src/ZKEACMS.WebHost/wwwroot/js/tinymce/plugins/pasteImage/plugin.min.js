/*!
 * http://www.zkea.net/
 * Copyright 2016 ZKEASOFT
 * http://www.zkea.net/licenses
 */
tinymce.PluginManager.add("pasteImage",function(n){n.on("paste",function(n){function e(n){var u,i,t;n.size<=1048e3&&(u=r.dom.createHTML("img",{src:"/images/loader.gif",id:(new Date).valueOf()}),r.selection.setContent(u),i=new XMLHttpRequest,i.open("POST","/admin/media/Upload"),i.onload=function(n){var i=JSON.parse(n.target.response),t;i.id&&(t=r.getContent(),t=t.replace(u,r.dom.createHTML("img",{src:i.url})),r.setContent(t),r.focus())},t=new FormData,t.append("file",n),t.append("folder","图片"),t.append("size",n.size),i.send(t))}var r=this,t,u,i,o,f;if(n.clipboardData?t=n.clipboardData:window.clipboardData&&(t=window.clipboardData),n.msConvertURL&&(u=t.files,u.length>0))for(i=0;i<u.length;i++)f=u[i],e(f);if(t&&t.items){if(t.getData("text/plain")||t.items.length===2&&t.items[0].type==="text/html"&&t.items[1].type.indexOf("image")!==-1)return;for(i=0;i<t.items.length;i++)o=new FileReader,t.items[i].type.indexOf("image")!==-1&&(f=t.items[i].getAsFile(),e(f))}})});