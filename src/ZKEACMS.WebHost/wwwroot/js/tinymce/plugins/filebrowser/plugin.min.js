/*!
 * http://www.zkea.net/
 * Copyright 2019 ZKEASOFT
 * http://www.zkea.net/licenses
 */
tinymce.PluginManager.add("filebrowser",function(n){function i(){window.top.Easy.ShowUrlWindow({url:"/admin/Media/MultiSelect",title:"媒体库",zindex:1e4,onLoad:function(i){window.top.$(this.document).find("#confirm").click(function(){$(".multi-select:not(.unchecked)",$(this).closest("body")).each(function(){var i=t({src:$(this).data("result"),name:$(this).data("name")});i.ele&&n.undoManager.transact(function(){n.selection.setContent(n.dom.createHTML(i.ele,i.attr,i.innerText))})});n.focus();n.nodeChanged();i.close()});window.top.$(this.document).on("click",".confirm",function(){var r=t({src:$(this).data("result"),name:$(this).data("name")});r.ele&&(n.undoManager.transact(function(){n.selection.setContent(n.dom.createHTML(r.ele,r.attr,r.innerText))}),n.focus(),n.nodeChanged());i.close()})}})}function t(n){var r=n.src,i=n.name,t={ele:"",attr:{},innerText:""},u=r.toLowerCase();return/.*(\.jpg|\.gif|\.png|\.jpeg|\.bmp|\.jpe)$/.test(u)?(t.ele="img",t.attr={src:r,title:i,alt:i}):/.*(\.mp4)$/.test(u)?(t.ele="video",t.attr={controls:"controls",src:r,title:i}):/.*(\.mp3|\.ogg|\.wav)$/.test(u)?(t.ele="audio",t.attr={controls:"controls",src:r,title:i}):(t.ele="a",t.attr={href:r,"class":"btn btn-default",download:i,title:i},t.innerText="下载"),t}n.ui.registry.addButton("filebrowser",{icon:"browse",tooltip:"媒体库",onAction:i})});