CodeMirror.defineExtension("autoFormatRange",function(n,t){function v(){h+="\n";f=!0;++a}for(var i,r=this,u=r.getMode(),o=r.getRange(n,t).split("\n"),s=CodeMirror.copyState(u,r.getTokenAt(n).state),y=r.getOption("tabSize"),h="",a=0,f=n.ch==0,e=0;e<o.length;++e){for(i=new CodeMirror.StringStream(o[e],y);!i.eol();){var c=CodeMirror.innerMode(u,s),p=u.token(i,s),l=i.current();i.start=i.pos;(!f||/\S/.test(l))&&(h+=l,f=!1);!f&&c.mode.newlineAfterToken&&c.mode.newlineAfterToken(p,l,i.string.slice(i.pos)||o[e+1]||"",c.state)&&v()}!i.pos&&u.blankLine&&u.blankLine(s);f||v()}r.operation(function(){r.replaceRange(h,n,t);for(var i=n.line+1,u=n.line+a;i<=u;++i)r.indentLine(i,"smart")})});CodeMirror.defineExtension("autoIndentRange",function(n,t){var i=this;this.operation(function(){for(var r=n.line;r<=t.line;r++)i.indentLine(r,"smart")})});